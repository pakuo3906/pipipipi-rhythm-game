# Beat Slice: Pipipipi Edition - 要件定義書 v1.2

## 概要
| 項目 | 内容 |
|------|------|
| タイトル | Beat Slice: Pipipipi Edition |
| 楽曲 | 「ぴぴぴ… しんごう…」by pa9wo |
| 再生時間 | 217.87秒 |
| BPM | 150 |
| 譜面 | pipipipi_shingou_chart.json |
| ノート数 | 222個（tap/hold） |
| 対応環境 | Webブラウザ（PC） |
| 操作方法 | マウススライス |

## 譜面仕様
| 項目 | 内容 |
|------|------|
| フォーマット | JSON |
| 構造 | songInfo + chart配列 |
| レーン | A（左）、S（中央）、D（右） |
| ノートタイプ | tap（瞬間判定）、hold（持続判定） |
| 時間単位 | 秒（小数点以下1桁） |
| 最終ノート | 217.0秒 |

## マウス操作仕様
| 要素 | 詳細 |
|------|------|
| 判定方法 | マウスカーソルのスライス動作 |
| 判定条件 | ノーツZ=0到達時、マウスが範囲内 + 速度閾値以上 |
| 速度閾値 | 300px/s以上 |
| hold判定 | クリック開始 → 指定時間内範囲維持 |
| 3D移動 | Z軸方向直線移動（Three.js） |

## 判定・スコアシステム
| 判定 | 許容誤差 | 得点 | コンボ |
|------|----------|------|------|
| PERFECT | ±50ms | 1000点 | +1 |
| GOOD | ±100ms | 500点 | +1 |
| MISS | それ以外 | 0点 | リセット |

| スコア計算 | 詳細 |
|------------|------|
| 満点 | 222,000点（222ノート × 1000点） |
| フルコンボ | 全ノートPERFECT or GOOD |
| クリア条件 | 最後まで演奏完了 |

## UI・HUD構成
| 要素 | 表示位置・内容 |
|------|---------------|
| スコア | 右上、リアルタイム更新 |
| コンボ | 中央、ヒット時表示 |
| 判定文字 | 中央、PERFECT/GOOD/MISS |
| タイマー | 楽曲再生時間表示 |
| プレカウント | 3, 2, 1, Start! |
| リザルト | 総スコア、PERFECT数、MISS数、RETRYボタン |

## 技術仕様
| 分野 | 技術・要件 |
|------|-----------|
| 3D描画 | Three.js |
| 音楽再生 | Tone.js / Howler.js |
| タイミング同期 | requestAnimationFrame + 音楽時間 |
| UI構築 | HTML + CSS / React + Tailwind |
| アニメーション | anime.js / GSAP |
| 対象FPS | 60fps |
| 音声遅延 | 補正機能あり |

## パフォーマンス要件
| 項目 | 要件 |
|------|------|
| フレームレート | 60fps維持 |
| 音声遅延 | 50ms以内 |
| 初回読み込み | 5秒以内 |
| メモリ使用量 | 512MB以下 |
| CPU使用率 | 30%以下 |

## 対応ブラウザ
| ブラウザ | バージョン |
|----------|-----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

## 追加機能仕様
| 機能 | 詳細 |
|------|------|
| ポーズ | Spaceキーで一時停止・再開 |
| リトライ | 途中リスタート可能 |
| 設定 | 音量、判定調整、キー設定 |
| カリブレーション | 判定タイミング調整 |

## デプロイメント
| 項目 | 仕様 |
|------|------|
| ホスティング | GitHub Pages / Vercel |
| 埋め込み | iframe対応 |
| CDN | 音楽ファイル配信 |
| キャッシュ | Service Worker |
| モニタリング | Google Analytics |

## 開発フェーズ
1. **Phase 1**: 基本ゲームエンジン（Three.js + 音楽同期）
2. **Phase 2**: マウス判定システム
3. **Phase 3**: UI・HUD・エフェクト
4. **Phase 4**: 設定・カリブレーション
5. **Phase 5**: 最適化・デプロイ

## 制約事項
- 楽曲ファイルは3.5MB以下
- WebGL対応必須
- タッチデバイス非対応
- オフライン非対応

## 品質保証
- 全ブラウザでの動作確認
- 様々なPC環境でのパフォーマンステスト
- 音楽と映像の同期精度検証
- アクセシビリティ対応確認

---
*更新日: 2025-07-09*
*バージョン: 1.2*